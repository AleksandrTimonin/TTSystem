

<div>
    <nav class="navbar navbar-expand-lg navbar-light bg-light" ng-show="isAllowed('EMPLOYEE')">
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item" ng-show="isAllowed('EXECUTOR')||isAllowed('MANAGER')">
                    <a class="nav-link" href="#!/income">Все заявки</a>
                </li>
                <li class="nav-item" ng-show="isAllowed('EXECUTOR')||isAllowed('MANAGER')">
                    <a class="nav-link" href="#!/assigned">Назначеные заявки</a>
                </li>
                <li class="nav-item" ng-show="isAllowed('SENIOR')">
                    <a class="nav-link" href="#!/statistics">Статистика</a>
                </li>
                <li class="nav-item" ng-show="isAllowed('ADMIN')">
                    <a class="nav-link" href="#!/admin">Администрирование</a>
                </li>
            </ul>


        </div>

    </nav>
    <p></p>
    <h3>Все заявки</h3>
    <p></p>
    <div ng-show="isAllowed('EMPLOYEE')">
        <div id="AlertInAssign"></div>
        <div class="accordion accordion-flush" id="accordion"  ng-repeat="o in OrdersPage.content">
            <div class="accordion-item">
                <h2 class="accordion-header" id="fh{{o.id}}">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#fc{{o.id}}" aria-expanded="false" aria-controls="fc{{o.id}}">
                        {{o.id}} : {{o.username}} : {{o.title}}
                    </button>
                </h2>
                <div id="fc{{o.id}}" class="accordion-collapse collapse" aria-labelledby="fh{{o.id}}" data-bs-parent="#accordion">
                    <div class="accordion-body">
                        <table class="table table-primary table-borderless">
                            <thead>
                            <tr>

                                <th scope="col" colspan="4" class="table-active">Описание</th>

                            </tr>
                            </thead>
                            <tbody>
                            <tr>

                                <td colspan="4" class="table-active">{{o.description}}</td>
                            </tr>
                            </tbody>
                            <thead>
                            <tr>
                                <th scope="col">ID</th>
                                <th scope="col">Пользователь</th>
                                <th scope="col">Заголовок</th>
                                <th scope="col">Статус</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>{{o.id}}</td>
                                <td>
                                    <button class="btn btn-warning" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight{{o.id}}" ng-click="loadUsersInfo(o.username)" aria-controls="offcanvasRight{{o.id}}">{{o.username}}</button>
                                </td>
                                <td>{{o.title}}</td>
                                <td>{{o.status}}</td>
                            </tr>
                            </tbody>>
                            <thead>
                            <tr>
                                <th colspan="2" scope="col">Создан</th>

                                <th colspan="2" scope="col">Закрыт</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td colspan="2">{{o.createdAt}}</td>

                                <td colspan="2">{{o.completedAt}}</td>
                            </tr>
                            </tbody>
                            <thead>
                            <tr>
                                <th scope="col" colspan="4" class="table-active">Исполнители</th>


                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td colspan="2" class="table-active">
                                    <button class="btn btn-warning" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight{{o.id}}x2"ng-click="info(o.executors,o.id)" aria-controls="offcanvasRight{{o.id}}x2">{{o.executors}}</button></td>
                                <td  class="table-active">
                                    <button ng-show="isCreated(o.status)" type="button" ng-click="assignMe(o.id)" class="btn btn-warning">Взять</button>
                                    <button ng-show="!isCreated(o.status)" type="button" disabled class="btn btn-outline-warning">Взять</button>
                                </td>
                                <td class="table-active">
                                    <div ng-show="isAllowed('MANAGER')">
                                        <div class="dropdown">
                                        <button ng-show="!isCompleted(o.status)" class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                            Назначить
                                        </button>
                                            <button ng-show="isCompleted(o.status)" class="btn btn-outline-secondary" type="button" disabled  aria-expanded="false">
                                                Назначить
                                            </button>
                                        <ul class="dropdown-menu"  aria-labelledby="dropdownMenuButton1">
                                            <div ng-repeat="e in Employers.list">

                                                <li>

                                                    <button  type="button" ng-click="isAssigned(o.executors,e,o.id)" class="btn btn-secondary dropdown-item">{{e.username}}</button>
                                                </li>


                                            </div>
                                        </ul>

                                        </div>
                                    </div>
                                </td>
                            </tr>


                            </tbody>
                            <thead>
                            <tr>
                                <th scope="col" colspan="4" class="table-active">Комментарий сотрудника </th>

                            </tr>
                            </thead>
                            <tbody>

                                <tr ng-repeat="c in o.commits track by $index">
                                    <td  colspan="4" class="table-active">{{c}}</td>
                                </tr>


                                <tr ng-show="isAllowed('MANAGER')&&isCreated(o.status)">
                                    <td colspan="3" class="table-active">
                                        Если заявка не относится к отделу IT ее можно завершить тут с комментарием по умолчанию
                                    </td>
                                    <td class="table-active">
                                    <button type="button" ng-click="cancelOrder(o.id)" class="btn btn-outline-danger">Отклонить</button>

                                    </td>
                                </tr>

                            </tbody>






                        </table>


                        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight{{o.id}}" aria-labelledby="offcanvasRightLabel">
                            <div class="offcanvas-header">
                                <h5 id="offcanvasRightLabel{{o.id}}">О пользователе</h5>
                                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            </div>
                            <div class="offcanvas-body">
                                <table class="table">

                                    <tbody>
                                    <tr>
                                        <th scope="row">Имя</th>
                                        <td>{{currentUser.firstName}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Фамилия</th>
                                        <td>{{currentUser.lastName}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Отчество</th>
                                        <td>{{currentUser.patronymic}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Почта</th>
                                        <td>{{currentUser.email}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">Телефон</th>
                                        <td>{{currentUser.phone}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">username</th>
                                        <td>{{currentUser.username}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">компания</th>
                                        <td>{{currentUser.company}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">корпус</th>
                                        <td>{{currentUser.building}}</td>
                                    </tr>
                                    <tr>
                                        <th scope="row">офис</th>
                                        <td>{{currentUser.office}}</td>
                                    </tr>

                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight{{o.id}}x2" aria-labelledby="offcanvasRightLabel">
                            <div class="offcanvas-header">
                                <h5 id="offcanvasRightLabel{{o.id}}x2">Инфорнация о процессе</h5>
                                <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                            </div>
                            <div class="offcanvas-body" ng-repeat="proc in processes">
                                <table class="table" >

                                    <tbody>
                                    <div >
                                        <tr >
                                            <th scope="row">Исполнитель</th>
                                            <td>{{proc.executor}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Назначен</th>
                                            <td>{{proc.assignedAt}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Принял</th>
                                            <td>{{proc.acceptedAt}}</td>
                                        </tr>
                                        <tr>
                                            <th scope="row">Закрыл</th>
                                            <td>{{proc.finishedAt}}</td>
                                        </tr>
                                    </div>


                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>



        <p></p>
        <div>
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    <li class="page-item" ng-repeat="pageIndex in paginationArray">
                        <button class="page-link" ng-click="loadOrders(pageIndex)">{{pageIndex}}</button>
                    </li>
                </ul>
            </nav>
        </div>
    </div>

</div>